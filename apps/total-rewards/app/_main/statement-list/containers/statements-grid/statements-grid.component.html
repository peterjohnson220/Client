<div class="h-100">
  <pf-async-container class="h-100"
    [loading]="statementsLoading$ | async" [loadingError]="statementsLoadingError$ | async">
    <kendo-grid
      [data]="statementsGridData$ | async"
      [pageSize]="(statementsGridState$ | async)?.take"
      [skip]="(statementsGridState$ | async)?.skip"
      [sort]="(statementsGridState$ | async)?.sort"
      [filter]="(statementsGridState$ | async)?.filter"
      [resizable]="true"
      [sortable]="true"
      [pageable]="{ buttonCount: 5, info: true }"
      (dataStateChange)="onDataStateChange($event)">
      <kendo-grid-column field="Name" title="Statement Name">
        <ng-template kendoGridCellTemplate let-dataItem>
          <span class="name-link" (click)="navigateToStatementEdit(dataItem.Id)">{{dataItem.Name}}</span>
        </ng-template>
      </kendo-grid-column>

      <kendo-grid-column field="CreatedBy" title="Created By"></kendo-grid-column>
      <kendo-grid-column field="CreatedDate" title="Created Date">
        <ng-template kendoGridCellTemplate let-dataItem>
          {{ dataItem.CreatedDate | date: 'MMM dd yyyy' }}
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column field="LastGeneratedDate" title="Last Generated">
        <ng-template kendoGridCellTemplate let-dataItem>
          <span *ngIf="dataItem.LastGeneratedDate; else noGeneratedDate">
            {{ dataItem.LastGeneratedDate | date: 'MMM dd yyyy' }}
          </span>
          <ng-template #noGeneratedDate>
            --
          </ng-template>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column field="LastGeneratedBy" title="Generated By">
        <ng-template kendoGridCellTemplate let-dataItem>
          <span *ngIf="dataItem.LastGeneratedBy; else noGeneratedBy">
            {{dataItem.LastGeneratedBy}}
          </span>
          <ng-template #noGeneratedBy>--</ng-template>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column field="Employees" title="Employees">
        <ng-template kendoGridCellTemplate let-dataItem>
          <span *ngIf="dataItem.Employees && dataItem.Employees > 0; else noEmployees">
            {{dataItem.Employees}}
          </span>
          <ng-template #noEmployees>--</ng-template>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column field="Jobs" title="Jobs">
        <ng-template kendoGridCellTemplate let-dataItem>
          <span *ngIf="dataItem.Jobs && dataItem.Jobs > 0; else noJobs">
            {{dataItem.Jobs}}
          </span>
          <ng-template #noJobs>--</ng-template>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column field="Status" title="Status"></kendo-grid-column>
      <kendo-grid-column width="40">
        <ng-template kendoGridCellTemplate let-statement="dataItem">
          <pf-grid-action-menu
            [isOpen]="(openActionMenuStatementId$ | async) === statement?.Id"
            [statement]="statement"
            (open)="onActionMenuOpen($event)"
            (close)="onActionMenuClose()"
            (previewClick)="onActionMenuPreviewClick($event)"
            (editClick)="onActionMenuEditClick($event)"
            (generateStatementClick)="onActionMenuGenerateStatementClick($event)"

            (copyClick)="onActionMenuCopyClick($event)"
            (deleteClick)="onActionMenuDeleteClick($event)"
          ></pf-grid-action-menu>
        </ng-template>
      </kendo-grid-column>
    </kendo-grid>
  </pf-async-container>
</div>
