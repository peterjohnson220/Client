<div class="dashboards h-100 d-flex flex-column">

  <pf-dashboards-header
    [thumbnailsViewEnabled]="thumbnailsViewSettingEnabled"
    [hasFavorites]="anyFavorites">
  </pf-dashboards-header>

  <ng-container *ngIf="(companyWorkbooksAsync$ | async) as companyWorkbooksAsync">
    <pf-async-container
      [loading]="companyWorkbooksAsync.loading"
      [loadingError]="companyWorkbooksAsync.loadingError"
      [loadingErrorMessage]="'Error Loading Dashboards'"
      [hideReloadButton]="true">
    </pf-async-container>

    <div *ngIf="!thumbnailsViewSettingEnabled" class="workbooks-container row" dragula="workbooks" [(dragulaModel)]="filteredCompanyWorkbooks">
      <ng-container *ngIf="filteredCompanyWorkbooks?.length">
        <div *ngFor="let workbook of filteredCompanyWorkbooks; trackBy: trackByFn"
              class="col-xs-12 col-md-6 col-lg-4 col-xl-3 workbook-card">
          <pf-workbook-card
            [workbook]="workbook"
            (favoriteClicked)="handleFavoriteClicked($event)"
            (tagClicked)="handleTagWorkbookClicked($event)"
            (openViewsClicked)="handleOpenViewsClicked($event)">
          </pf-workbook-card>
        </div>
      </ng-container>
    </div>

    <ng-container *ngIf="thumbnailsViewSettingEnabled && companyWorkbooksAsync?.obj?.length">
      <ng-container *ngFor="let workbook of companyWorkbooksAsync.obj; trackBy: trackByFn">
        <pf-views [workbook]="workbook"></pf-views>
      </ng-container>
    </ng-container>

  </ng-container>
</div>

<pf-tag-workbook-modal
  [selectedWorkbook]="selectedWorkbook"
  [saving]="savingTag$ | async"
  [tags]="tags$ | async"
  (saveClicked)="handleSaveTagClicked($event)">
</pf-tag-workbook-modal>
