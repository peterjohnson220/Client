<div class="data-view-grid">
  <pf-async-container *ngIf="(dataAsync$ | async) as dataAsync"
    [loading]="dataAsync.loading"
    [loadingError]="dataAsync.loadingError"
    [loadingErrorMessage]="'Error loading data'"
    [hideReloadButton]="true">
  </pf-async-container>

  <kendo-grid
    [kendoGridBinding]="(dataAsync$ | async)?.obj"
    [sortable]="sortableConfig"
    [sort]="sortDesc"
    [resizable]="true"
    (scrollBottom)="handleScrollBottom()"
    (sortChange)="handleSortChange($event)">
    <kendo-grid-column *ngFor="let field of (fields$ | async); trackBy: trackByFn"
      [field]="field.KendoGridField"
      [title]="field.DisplayName"
      [headerClass]="'grid-header'"
      width="150">

      <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
        <fa-icon *ngIf="kendoSortDesc?.field === column.field && kendoSortDesc?.dir === 'desc'"
          class="sort-icon" [icon]="['far', 'long-arrow-down']">
        </fa-icon>
        <fa-icon *ngIf="kendoSortDesc?.field === column.field && kendoSortDesc?.dir === 'asc'"
          class="sort-icon" [icon]="['far', 'long-arrow-up']">
        </fa-icon>
        <span class="k-link">{{column.title}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem>
        <span *ngIf="!!dataItem[field.SourceName];else blankCellTemplate">{{dataItem[field.SourceName]}}</span>
      </ng-template>
      <ng-template #blankCellTemplate>
        <div class="empty-row">N/A</div>
      </ng-template>

    </kendo-grid-column>
  </kendo-grid>
</div>
