
<p class="font-weight-bold">Create File to Export</p>
<div class="form-container">
  <table>
    <tr>
      <td><label for="filename" class="font-weight-bold">File Name: </label></td>
      <td>
        <input type="text" id="filename" name="filename" [(ngModel)]="schedule.FileName">
      </td>
    </tr>
    <tr>
      <td colspan="2" class="indent">Select Content to Export</td>
    </tr>
    <tr>
      <td></td>
      <td>
        <select id="view" [(ngModel)]="schedule.ViewId">
          <option *ngFor="let view of views" [ngValue]="view.Id">{{view.Name}}</option>
        </select>
      </td>
    </tr>
    <tr>
      <td colspan="2" class="indent">Select Jobs to Export</td>
    </tr>
    <tr>
      <td></td>
      <td>
        <select id="filter" [(ngModel)]="schedule.Filter">
          <option>All</option>
          <option *ngFor="let filter of filters" [ngValue]="filter.Name">{{filter.Name}}</option>
        </select>
      </td>
    </tr>
    <tr>
      <td colspan="2" class="indent">Select File Type</td>
    </tr>
    <tr>
      <td></td>
      <td>
        <select id="fileType" [(ngModel)]="schedule.Format" (change)="onScheduleFormatChange()">
          <option value="xlsx">Excel</option>
          <option value="csv">CSV</option>
        </select>
        <div class="d-inline-block" [ngClass]="schedule.Format != 'csv'?'visibility-hidden':''">
        <label for="formatSeparatorType" class="mr-2">Separator Type: </label>
        <select id="formatSeparatorType" [(ngModel)]="schedule.FormatSeparatorType">
          <option value="comma">Comma</option>
          <option value="tab">Tab</option>
          <option value="pipe">Pipe</option>
        </select>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan="2" class="indent">Include Delimiters</td>
    </tr>
    <tr>
      <td></td>
      <td>
        <select id="includeDelimiters" [disabled]="schedule.IncludeFormatting" [(ngModel)]="schedule.IncludeDelimiters">
          <option [ngValue]="true">Yes</option>
          <option [ngValue]="false">No</option>
        </select>
      </td>
    </tr>
    <tr>
      <td colspan="2" class="indent">Include Formatting</td>
    </tr>
    <tr>
      <td></td>
      <td>
        <select id="includeFormatting" [disabled]="schedule.IncludeDelimiters" [(ngModel)]="schedule.IncludeFormatting">
          <option [ngValue]="true">Yes</option>
          <option [ngValue]="false">No</option>
        </select>
      </td>
    </tr>
    <tr>
      <td colspan="2" class="font-weight-bold">Select Frequency</td>
    </tr>
    <tr>
      <td colspan="2">
        <table class="nested-table">
          <tr>
            <td><input type="radio" name="frequency" value="One-time" [(ngModel)]="schedule.Frequency" (change)="onFrequencyChange()"> One-time </td>
            <td><input type="radio" name="frequency" value="Weekly" [(ngModel)]="schedule.Frequency" (change)="onFrequencyChange()"> Weekly</td>
            <td><input type="radio" name="frequency" value="Monthly" [(ngModel)]="schedule.Frequency" (change)="onFrequencyChange()"> Monthly </td>
          </tr>
          <tr *ngIf="schedule.Frequency === 'One-time'">
            <td colspan="3"><p>The export will be sent to your sFTP site upon save</p></td>
          </tr>
          <tr *ngIf="schedule.Frequency === 'Weekly'">
            <td colspan="3">
              <input type="checkbox" name="dayOfWeek" id="weeklySunday" value="1" (change)="onDayOfWeekChange($event)"> <label for="weeklySunday" class="weekly-checkbox"> Sunday</label>
              <input type="checkbox" name="dayOfWeek" id="weeklyMonday" value="2" (change)="onDayOfWeekChange($event)"> <label for="weeklyMonday" class="weekly-checkbox"> Monday</label>
              <input type="checkbox" name="dayOfWeek" id="weeklyTuesday" value="3" (change)="onDayOfWeekChange($event)"> <label for="weeklyTuesday" class="weekly-checkbox"> Tuesday</label>
              <input type="checkbox" name="dayOfWeek" id="weeklyWednesday" value="4" (change)="onDayOfWeekChange($event)"> <label for="weeklyWednesday" class="weekly-checkbox"> Wednesday</label>
              <input type="checkbox" name="dayOfWeek" id="weeklyThursday" value="5" (change)="onDayOfWeekChange($event)"> <label for="weeklyThursday" class="weekly-checkbox"> Thursday</label>
              <input type="checkbox" name="dayOfWeek" id="weeklyFriday" value="6" (change)="onDayOfWeekChange($event)"> <label for="weeklyFriday" class="weekly-checkbox"> Friday</label>
              <input type="checkbox" name="dayOfWeek" id="weeklySaturday" value="7" (change)="onDayOfWeekChange($event)"> <label for="weeklySaturday" class="weekly-checkbox"> Saturday</label>
            </td>
          </tr>
          <tr *ngIf="schedule.Frequency === 'Monthly'">
            <td colspan="3">
              <select [(ngModel)]="schedule.Occurrence">
                <option value="1">First</option>
                <option value="2">Second</option>
                <option value="3">Third</option>
                <option value="4">Fourth</option>
              </select>
              <select [(ngModel)]="schedule.DayOfWeek">
                <option value="1">Sunday</option>
                <option value="2">Monday</option>
                <option value="3">Tuesday</option>
                <option value="4">Wednesday</option>
                <option value="5">Thursday</option>
                <option value="6">Friday</option>
                <option value="7">Saturday</option>
              </select>
               of every <input type="text" class="small-input" [(ngModel)]="schedule.MonthlyOccurrence"> months
            </td>
          </tr>
          <tr *ngIf="schedule.Frequency === 'Monthly' || schedule.Frequency === 'Weekly'">
            <td colspan="3"><p class="message">Files are sent between 12:00 AM and 6:00 AM EST on the day selected</p></td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
  <button class="btn btn-primary" (click)="submitForm()">Save</button>
  <div class="bad-schedule" id="invalidSchedule" *ngIf="!validSchedule">
    <p>Save Schedule failed. Please enter a valid schedule.</p>
  </div>
</div>
<br>
<br>
<p class="font-weight-bold">Saved Schedules</p>
<div class="form-container">
  <table class="saved-schedules">
    <ng-container *ngFor="let existingSchedule of schedules">
      <tr>
        <td (click)="onScheduleClick(existingSchedule.FileName)" class="schedule-name">{{existingSchedule.FileName}}</td>
        <td>
          <div (click)="removeSchedule(existingSchedule.FileName)">
            <fa-icon icon="trash" class="remove-schedule"></fa-icon>
          </div>
        </td>
      </tr>
      <tr id="{{existingSchedule.FileName}}" *ngIf="clickedSchedule === existingSchedule.FileName">
        <td colspan="2" class="indent schedule-info">
          <p *ngIf="existingSchedule.Frequency === 'One-time'">Sent on {{existingSchedule.Create_Date | date:'shortDate'}}</p>
          <p *ngIf="existingSchedule.Frequency === 'Weekly'">Sent Weekly every {{daysOfWeekAsString(existingSchedule.DayOfWeek)}}</p>
          <p *ngIf="existingSchedule.Frequency === 'Monthly'">Sent the {{occurrenceAsString(existingSchedule.Occurrence)}} {{daysOfWeekAsString(existingSchedule.DayOfWeek)}} of every {{existingSchedule.MonthlyOccurrence}} month(s)</p>
          <p>Using {{getViewName(existingSchedule.ViewId)}} view</p>
          <p *ngIf="existingSchedule.Filter === 'All'">All Jobs</p>
          <p *ngIf="existingSchedule.Filter !== 'All'">Using {{existingSchedule.Filter}} filter</p>
          <p *ngIf="existingSchedule.IncludeDelimiters">Including Delimiters</p>
          <p *ngIf="existingSchedule.IncludeFormatting">Including Formatting</p>
          <p *ngIf="existingSchedule.Format">Using {{existingSchedule.Format}} file format <span *ngIf="existingSchedule.Format === 'csv'">with {{existingSchedule.FormatSeparatorType || 'comma'}} separator</span></p>
        </td>
      </tr>
    </ng-container>
  </table>
</div>

