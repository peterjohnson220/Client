  <div class="mapping-info-container card h-100">
    <div class="card-header">
      <div class="align-self-center mr-auto">
        Mapping Information
      </div>
      <button *ngIf="selectedExchangeJobMapping.Mapped"
              class="btn btn-sm"
              [ngClass]="{ 'btn-secondary': !editingMapping, 'btn-warning': editingMapping }"
              (click)="toggleEditing()">
        {{ editingMapping ? 'Cancel Editing' : 'Edit Mapping' }}
      </button>

      <div (click)="close()" class="close-btn">
        <i class="far fa-times"></i>
      </div>
    </div>
    <div class="card-body d-flex">

      <pf-job-info-container
        [job]="exchangeJobInfo">
      </pf-job-info-container>

      <div class="vertical-separator"></div>

      <pf-job-info-container
        *ngIf="selectedExchangeJobMapping.Mapped && !editingMapping"
        [job]="companyJobInfo"
        [showJobCode]="true">
      </pf-job-info-container>

      <div class="company-job-mapping-container" *ngIf="!selectedExchangeJobMapping.Mapped || editingMapping">
        <pf-input-debounce
          [placeholderText]="'Search for a Company Job...'"
          [(ngModel)]="companyJobQuery"
          [disabled]="applyingMapping$ | async"
          [hideClearBtn]="true"
          (valueChanged)="handleSearchValueChanged($event)">
        </pf-input-debounce>

        <div class="mapping-results-container" [class.remove-scroll]="companyJobsToMapToLoading$ | async">
          <pf-async-container
            [loading]="companyJobsToMapToLoading$ | async"
            [loadingError]="companyJobsToMapToLoadingError$ | async"
            [hideReloadButton]="true">

            <ng-container *ngIf="(companyJobsToMapTo$ | async).length">

              <pf-company-job-map-result
                *ngFor="let companyJobToMapTo of companyJobsToMapTo$ | async"
                [companyJobToMapTo]=companyJobToMapTo
                [applyingMapping]="applyingMapping$ | async"
                [applyingMappingError]="applyingMappingError$ | async"
                [selectedMapping]="(selectedMappingCompanyJobId$ | async) == companyJobToMapTo.CompanyJobId"
                (applyMapping)="handleApplyMapping($event)">
              </pf-company-job-map-result>

            </ng-container>

            <ng-container *ngIf="!(companyJobsToMapTo$ | async).length && !(companyJobsToMapToLoading$ | async)">

              <div class="d-flex flex-column mt-5 align-items-center">
                <h6 class="mb-1">No Results for {{ debouncedQueryValue || selectedExchangeJobMapping.ExchangeJobTitle }}</h6>
                <h5><small class="text-muted">Please change your filter criteria to search again.</small></h5>
              </div>

            </ng-container>

          </pf-async-container>

        </div>

      </div>

    </div>
  </div>
