<pf-card-layout pageTitle="Summary" [page]="comphubPages.Summary" pageIconClass="file-alt">

  <ng-container page-content>
    <div class="row summary-page-content">
      <div class="col-3 px-3 py-6">
        <div class="summary-panel-wrapper p-3">
          <div class="summary-panel-item">
            <div class="summary-panel-item-header">Rate</div>
            <div class="summary-panel-item-value">
              <kendo-dropdownlist class="rates-dropdown" [attr.data-qa-id]="'ddm-rate'" [data]="rates" textField="Name"
                valueField="Value" [valuePrimitive]="true" [(ngModel)]="selectedRate"
                (selectionChange)="handleRateSelectionChange($event)">
              </kendo-dropdownlist>
            </div>
          </div>
          <div class="summary-panel-item">
            <div class="summary-panel-item-header">Effective Date</div>
            <div class="summary-panel-item-value">{{firstDayOfMonth | date:'MM/dd/yyyy'}}</div>
          </div>
          <div class="summary-panel-item">
            <div class="summary-panel-item-header">Currency</div>
            <div class="summary-panel-item-value">{{selectedPaymarket.CurrencyCode}}</div>
          </div>
          <div class="summary-panel-item">
            <div class="summary-panel-item-header">Market</div>
            <div class="summary-panel-item-value">{{selectedPaymarket.PayMarketName}}</div>
          </div>
          <div class="summary-panel-item">
            <div class="summary-panel-item-header">Location</div>
            <div class="summary-panel-item-value">{{selectedPaymarket.Location}}</div>
          </div>
          <div class="summary-panel-item">
            <div class="summary-panel-item-header">Industry</div>
            <div class="summary-panel-item-value">{{selectedPaymarket.Industry}}</div>
          </div>
          <div class="summary-panel-item">
            <div class="summary-panel-item-header">Size ({{selectedPaymarket.SizeLabel}})</div>
            <div class="summary-panel-item-value">{{selectedPaymarket.Size}}</div>
          </div>
          <div class="summary-panel-item" *ngIf="selectedPaymarket.OrganizationTypeId">
            <div class="summary-panel-item-header">Organization Type</div>
            <div class="summary-panel-item-value">{{getOrganizationType(selectedPaymarket.OrganizationTypeId)}}</div>
          </div>
          <div class="summary-panel-item" *ngIf="selectedPaymarket.IsGovernmentContractor != null">
            <div class="summary-panel-item-header">Government Contractor</div>
            <div class="summary-panel-item-value">{{selectedPaymarket.IsGovernmentContractor ? 'Yes' : 'No'}}</div>
          </div>
        </div>
      </div>
      <div class="col-9">
        <div class="header">
          <div class="job-title">{{this.selectedJob?.JobTitle}}</div>
          <div class="actions">
            <button class="btn btn-secondary" (click)="handleDownloadPdfClicked()" [disabled]="selectedJob?.Loading" ngbTooltip="Export">
              <fa-icon icon="file-pdf"></fa-icon>
            </button>
          </div>
        </div>
        <div class="csd-label">Payscale Crowdsourced Data</div>
        <div class="async-container-positioner">
          <pf-async-container [loading]="selectedJob?.Loading">
            <div class="row rate-value-row">
              <div class="col-md-3">
                <h3 class="rate-value-label">
                  {{selectedBaseValue | currency:selectedPaymarket.CurrencyCode : 'symbol-narrow' : isHourly ? '1.2-2' : '1.0-0'}}
                </h3> BASE PAY
              </div>
              <div class="col-md-3">
                <h3 class="rate-value-label">
                  {{selectedTccValue | currency:selectedPaymarket.CurrencyCode : 'symbol-narrow' : isHourly ? '1.2-2' : '1.0-0'}}
                </h3> TOTAL CASH
              </div>
              <div class="col-md-6">
                <div class="row rate-display">
                  <div class="h rate-display-label">Rates displayed at</div>
                  <kendo-dropdownlist class="rate-display-dropdown" [attr.data-qa-id]="'ddm-rate-display'"
                    id="rateDisplay" [data]="displayRates" textField="Name" valueField="Value" [popupSettings]="{
                                        width: '11.1em'
                                      }" [valuePrimitive]="true" [(ngModel)]="selectedDisplayRate"
                    (selectionChange)="handleDisplayRateSelectionChange($event)">
                  </kendo-dropdownlist>
                </div>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-md-10">
                <h4>Market Data Details</h4>
              </div>
            </div>
            <div>
              <pf-csd-pricing-graph [csdPricingData]="this.basePayGraph" [graphType]="PricingGraphTypeEnum.Base"></pf-csd-pricing-graph>
              <pf-csd-pricing-graph [csdPricingData]="this.tccPayGraph" [graphType]="PricingGraphTypeEnum.TCC"></pf-csd-pricing-graph>
            </div>
            <hr>
          </pf-async-container>
        </div>
        <ng-container *ngIf="summaryPage" #CompensableFactors>
          <pf-compensable-factors [selectedJobTitle]="selectedJob?.JobTitle"
            [selectedCountry]="this.workflowContext.activeCountryDataSet.CountryName"
            [selectedPaymarketId]="this.selectedPaymarket.CompanyPayMarketId" [selectedFactors]="this.selectedFactors"
            [loading]="selectedJob?.Loading">
          </pf-compensable-factors>
        </ng-container>
      </div>
    </div>
  </ng-container>
</pf-card-layout>
