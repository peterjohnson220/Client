<div class="result" [class.dragging]="dragging">
  <div class="d-flex justify-content-between">
    <div class="d-flex">
      <div class="job-title">
        {{job.Title}}
      </div>
      <div class="job-code">
        ({{job.Code}})
      </div>
    </div>
  </div>
  <div class="dropzone" dragula="data-cuts-bag" [attr.data-job-id]="job.Id">
  </div>
  <div class="paymarket">
    {{job.Paymarket}}
  </div>

  <div class="d-flex mt-2">
    <div class="link" *ngIf="(job.TotalDataCuts > 0); else noCutsToShow" (click)="toggleDataCutsDisplay()">
      {{toggleDataCutsLabel}}
    </div>
    <div class="link mx-2">
      |
    </div>
    <div class="link" (click)="toggleJobDetailDisplay()">
      {{toggleJobDetailLabel}}
    </div>
  </div>

  <div *ngIf="showJobDetail" class="job-detail">
    <table>
      <tbody>
        <tr>
          <th>Family:</th>
          <td>{{job.Family || '-'}}</td>
        </tr>
        <tr>
          <th>Level:</th>
          <td>{{job.Level || '-'}}</td>
        </tr>
        <tr>
          <th>Job Description:</th>
          <td>
            <ng-container *ngIf="job.Description; else noJobDescription">
              <pf-ellipsis-view-more [copy]="true" [content]="job.Description" [maxLength]="300"></pf-ellipsis-view-more>
          </ng-container>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="data-cuts-container" *ngIf="showDataCuts && !job.LoadingDataCuts">
    <ng-container *ngIf="!job.LoadingDataCutsError;else loadingDataCutsError">
      <table class="data-cuts-table">
        <thead>
        <tr>
          <th>Title</th>
          <th class="text-center">Base 50th</th>
          <th class="text-center">TCC 50th</th>
          <th></th>
        </tr>
        </thead>
        <tbody>
          <tr *ngFor="let dataCut of job.JobMatchCuts" [class.highlight]="dataCut.UserJobMatchId == null">
            <td class="scope-cell">
              {{dataCut.JobTitle}} ({{dataCut.JobCode}}) - {{dataCut.Source}}
            </td>
            <td class="text-center">{{dataCut.Base50 ? formatCurrency(dataCut.Base50) : "-"}}</td>
            <td class="text-center">{{dataCut.TCC50 ? formatCurrency(dataCut.TCC50) : "-"}}</td>
            <td class="text-center"><fa-icon (click)="removeMatchCut(dataCut)" [icon]="['far', 'times']" size="lg" ></fa-icon></td>
          </tr>
        </tbody>
      </table>
    </ng-container>
  </div>
  <div class="my-2" *ngIf="job.LoadingDataCuts">
    <pf-loading-indicator [spinnerType]="'GIF'"></pf-loading-indicator> Loading Data Cuts...
  </div>
</div>

<ng-template #noJobDescription>
  <div class="no-job-description">
    No Job Description
  </div>
</ng-template>
<ng-template #noCutsToShow>
  <div class="no-cuts-to-show">
    No Cuts Added
  </div>
</ng-template>
<ng-template #loadingDataCutsError>
  <div class="loading-datacuts-error">
    <fa-icon icon="exclamation-triangle" class="icon"></fa-icon> Error loading data cuts. Please try again later.
  </div>
</ng-template>

