<pf-async-container [loading]="(loading$ | async) || (saving$ | async)" [smartLoadingMask]="true" [showSpinner]="false">
  <form id="user-form" [formGroup]="jobForm" autocomplete="nope">
    <h5>Standard Fields</h5><br>
    <div class="form-group row">
      <label class="col-2 col-form-label">Job Code <span class="text-danger">*</span></label>
      <div class="col-4">
        <input data-qa-id="txt-job-form-job-code" type="text" class="form-control" formControlName="JobCode" [maxlength]="JOB_CODE_FLSA_MAX_LENGTH"
          [ngClass]="{ 'is-invalid': !f.JobCode.valid && f.JobCode.touched }">
        <span *ngIf="f.JobCode.errors?.required" class="invalid-feedback">Job code is required</span>
        <span *ngIf="f.JobCode.errors?.duplicateJobCode" class="invalid-feedback">Job codes must be unique</span>
        <span *ngIf="f.JobCode.errors?.maxLengthTrimmed" class="invalid-feedback">Job code cannot be longer than {{JOB_CODE_FLSA_MAX_LENGTH}} characters</span>
      </div>
      <label class="col-2 col-form-label">Job Title <span class="text-danger">*</span></label>
      <div class="col-4">
        <input data-qa-id="txt-job-form-job-title" type="text" class="form-control" formControlName="JobTitle" [maxlength]="DEFAULT_MAX_LENGTH"
          [ngClass]="{ 'is-invalid': !f.JobTitle.valid && f.JobTitle.touched }">
        <span *ngIf="f.JobTitle.errors?.required" class="invalid-feedback">Job title is required</span>
        <span *ngIf="f.JobTitle.errors?.maxLengthTrimmed" class="invalid-feedback">Job title cannot be longer than {{DEFAULT_MAX_LENGTH}} characters</span>
      </div>        
    </div>
    <div class="form-group row">
      <label class="col-2 col-form-label">Job Family</label>
      <div class="col-4">
        <kendo-combobox
          data-qa-id="ddm-job-form-job-family"
          class="form-control"
          formControlName="JobFamily"
          [clearButton]="true"
          [kendoDropDownFilter]="filterSettings"
          [data]="jobFamilies$ | async"
          [allowCustom]="true"
          [ngClass]="{ 'is-invalid': !f.JobFamily.valid && f.JobFamily.touched }">
        </kendo-combobox>
        <span *ngIf="f.JobFamily.errors?.maxLengthTrimmed" class="invalid-feedback">Job Family cannot be longer than {{DEFAULT_MAX_LENGTH}} characters</span>        
      </div>
      <label class="col-2 col-form-label">Level</label>
      <div class="col-4">
        <input data-qa-id="txt-job-form-job-level" type="text" class="form-control" formControlName="JobLevel" [maxlength]="DEFAULT_MAX_LENGTH"
          [ngClass]="{ 'is-invalid': !f.JobLevel.valid && f.JobLevel.touched }">
        <span *ngIf="f.JobLevel.errors?.maxLengthTrimmed" class="invalid-feedback">Job level cannot be longer than {{DEFAULT_MAX_LENGTH}} characters</span>        
      </div>
    </div>
    <div class="form-group row">
      <label class="col-2 col-form-label">FLSA Status</label>
      <div class="col-4">
        <kendo-combobox
          data-qa-id="ddm-job-form-flsa-status"
          class="form-control"
          formControlName="FLSAStatus"
          [clearButton]="true"
          [kendoDropDownFilter]="filterSettings"
          [data]="jobFlsaStatuses$ | async"
          [allowCustom]="true"
          [ngClass]="{ 'is-invalid': !f.FLSAStatus.valid && f.FLSAStatus.touched }">
        </kendo-combobox>
        <span *ngIf="f.FLSAStatus.errors?.maxLengthTrimmed" class="invalid-feedback">FLSA Status cannot be longer than {{JOB_CODE_FLSA_MAX_LENGTH}} characters</span>
      </div>
    </div>
    <div *ngIf="(jobUserDefinedFields$ | async).length">
      <br>
      <hr>
      <h5>Custom Fields</h5><br>
        <div class="row">
          <div class="col-6">
            <div *ngFor="let udf of (jobUserDefinedFields$ | async) let isOdd=odd; let isEven=even">
              <div *ngIf="!isOdd" class="form-group row">
                <label class="col-4 col-form-label">{{udf.DispName}}</label>
                <div class="col-8">
                  <input
                    [attr.data-qa-id]="'txt-job-form-' + udf.ColumnName" 
                    [maxlength]="DEFAULT_MAX_LENGTH"
                    [formControlName]="udf.ColumnName"
                    type="text" class="form-control"
                    [ngClass]="{ 'is-invalid': !f[udf.ColumnName].valid && f[udf.ColumnName].touched }">
                    <span *ngIf="f.JobTitle.errors?.maxLengthTrimmed" class="invalid-feedback">
                      {{udf.DispName}} cannot be longer than {{DEFAULT_MAX_LENGTH}} characters
                    </span>
                </div>
              </div>
            </div>
          </div>
          <div class="col-6">
            <div *ngFor="let udf of (jobUserDefinedFields$ | async) let isOdd=odd; let isEven=even">
              <div *ngIf="isOdd" class="form-group row">
                <label class="col-4 col-form-label">{{udf.DispName}}</label>
                <div class="col-8">
                  <input
                    [attr.data-qa-id]="'txt-job-form-' + udf.ColumnName" 
                    [maxlength]="DEFAULT_MAX_LENGTH"
                    [formControlName]="udf.ColumnName"
                    type="text" class="form-control"
                    [ngClass]="{ 'is-invalid': !f[udf.ColumnName].valid && f[udf.ColumnName].touched }">
                    <span *ngIf="f.JobTitle.errors?.maxLengthTrimmed" class="invalid-feedback">
                      {{udf.DispName}} cannot be longer than {{DEFAULT_MAX_LENGTH}} characters
                    </span>
                </div>
              </div>
            </div>
          </div>
        </div>
    </div>
  </form>
</pf-async-container>    