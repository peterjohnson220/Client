<pf-page-with-title-bar class="wrapper">
  <ng-container page-title>
    {{entity | titlecase}} Page
  </ng-container>
  <ng-container page-actions>
    <pf-action-bar
      [entity]="entity"
      (onFilterSidebarToggle)="toggleFilterPanel($event)"
    ></pf-action-bar>
  </ng-container>
  <ng-container page-content>
    <div *ngIf="gridActionsTemplate" class="d-flex justify-content-end pb-3">
      <ng-container [ngTemplateOutlet]="gridActionsTemplate">
      </ng-container>
    </div>
    <!-- TODO: container divs/layout -->
    <div *ngIf="(filters$ | async).length" class="filter-pills-container" [class.background-light-grey]="displayFilterPanel">
      <pf-data-grid-filter-pills
        [listAreaColumns]="(dataFields$ | async)"
        [filters]="(filters$ | async)"
        (clearFilter)="clearFilter($event)"
        (clearAllFilters)="clearAllFilters()"
      ></pf-data-grid-filter-pills>
    </div>
    <div class="row no-gutters">
      <div [class.col-3]="isSplitView()" [class.col-9]="displayFilterPanel">
        <pf-grid
          [entity]="entity"
          [primaryKey]="primaryKey"
          [columnTemplates]="columnTemplates"
          [isCompact]="isSplitView()"
          [selection]="displayFilterPanel ? [] : selection"></pf-grid>
      </div>
      <div *ngIf="isSplitView()" class="col-9 pl-3">
        <ng-container [ngTemplateOutlet]="splitViewTemplate" [ngTemplateOutletContext]="{splitViewEmitter: splitViewEmitter}">
        </ng-container>
      </div>
      <!--Filter panel -->
      <div *ngIf="displayFilterPanel" class="col-3">
        <pf-filter-panel
          [selectedColumns]="(dataFields$ | async)"
          [filters]="(filters$ | async)"
          (close)="toggleFilterPanel(false)"
          (filterChanged)="handleFilterChanged($event)"
        ></pf-filter-panel>
      </div>
    </div>
  </ng-container>
</pf-page-with-title-bar>
