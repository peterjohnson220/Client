<ng-template #popContent>
  <div class="popover-body-container">
    <p>
      <pf-input-debounce [disabled]="viewDeleting || viewNameToBeDeleted" id="filter-search-box" [id]="'filter-chooser-search'" (valueChanged)="(filter = $event)" [placeholderText]="'Search for a Filter...'">
      </pf-input-debounce>
    </p>
    <div class="popover-body-content">
      <div class="list-group">
        <div *ngIf="savedViews && !(savedViews | filterArrayByName: filter).length">
          <h5>No Filters</h5>
        </div>
        <div *ngFor="let view of savedViews | filterArrayByName: filter;"
             class="list-group-item list-group-item-action p-2"
             [ngClass]="{'list-group-item-danger': viewNameToBeDeleted == view.Name,
             'disabled': ((viewNameToBeDeleted && viewNameToBeDeleted !== view.Name) || viewDeleting)}">
          <div class="row align-items-center">
            <div (click)="handleViewSelected(view)" class="col-10">
              <span>{{view.Name}}</span>
              <small class="filter-desc" [title]="view.Description">{{view.Description}}</small>
            </div>
            <div>
              <button [disabled]="viewNameToBeDeleted || viewDeleting" title="Delete" type="button" class="btn btn-secondary btn-sm user-filter-delete-btn" (click)="$event.stopPropagation(); deleteView(view.Name);">
                <fa-icon icon="trash-alt"></fa-icon>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="viewNameToBeDeleted || viewDeleting" class="footer justify-content-end p-2">
    <div class="delete-filter-btns">
      <button type="button" class="btn btn-danger" [disabled]="viewDeleting" (click)="$event.stopPropagation(); confirmDeleteView()">
        <span *ngIf="viewDeleting"><pf-loading-indicator></pf-loading-indicator> Deleting...</span>
        <span *ngIf="!viewDeleting">Delete</span>
      </button>
      <button (click)="$event.stopPropagation(); cancelDelete();" type="button" class="btn btn-secondary" [disabled]="viewDeleting">Cancel</button>
    </div>
  </div>

</ng-template>
<div class="btn-group">
  <button title="Filter" (click)="filterButtonClicked()" class="btn btn-secondary" [disabled]="disabled" [attr.data-qa-id]="'btn-grid-filter'">
    <fa-icon icon="sliders-h"></fa-icon>
  </button>
  <button [disabled]="disabled || (savedViews && !savedViews.length)" [title]="(savedViews && !savedViews.length) ? 'No Saved Filters' : 'Saved Filters'"
    type="button" id="filter-popover-btn" class="btn btn-secondary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true"
    aria-expanded="false" placement="bottom-right" #p="ngbPopover" popoverTitle="Saved Filters" [ngbPopover]="popContent"
    [autoClose]="'outside'" [attr.data-qa-id]="'btn-saved-filters'" (hidden)="cancelDelete()">
  </button>
</div>
