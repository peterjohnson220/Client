<div class="multi-select-container" pfClickElsewhere (clickElsewhere)="clickElsewhere()">
  <div class="selections-summary row align-items-center">
    <div *ngIf="labelText" class="main-label mr-2">{{ labelText }}</div>
    <div class="select-facade action-item rounded form-control flex-grow-1 d-flex col" (click)="toggleCheckboxPanel()">
      <span class="flex-grow-1 ellipsis-overflowing-text" [ngbTooltip]="getSelectionsString()"
        container="body">{{getSelectionsString()}}</span>
      <span><i class="k-i-arrow-s k-icon" style="padding-left: 0.3rem"></i></span>
    </div>
  </div>
  <div *ngIf="isExpanded" class="selections-container d-flex flex-column">
    <span *ngIf="isLoading" class="loading d-block mt-2 mb-2 text-center">
      <pf-loading-indicator></pf-loading-indicator>
    </span>
    <div *ngIf="!(isLoading)">
      <div class="input-group p-2">
        <div class="input-group-prepend">
          <span class="input-group-text pf-prepend-icon"><i class="fas fa-search fa-lg"></i></span>
        </div>
        <input type="text" [(ngModel)]="searchTerm" class="form-control d-block pf-search-input" placeholder="Search..." />
        <div class="input-group-append action-item" (click)="clearSearchTerm()">
          <span class="input-group-text pf-append-icon"><i class="fas fa-times"></i></span>
        </div>        
      </div>
      <div class="d-flex justify-content-start mx-2 mb-2">
        <button [disabled]="!hasSelections()" (click)="clearSelections()" class="btn btn-secondary clear-selections" [ngbTooltip]="'Clear Selections'">
          Clear Selections
        </button>
      </div>
      <div class="checkbox-container" (change)="emitChanges()">
        <ng-container *ngFor="let option of options; trackBy: trackByFn; let i=index;">
          <label class="checkbox-label d-block ellipsis-overflowing-text m-0 p-2"
            *ngIf="option.DisplayName.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1"
            [ngClass]="highlightSelected && option.IsSelected? 'highlight' :''">
            <input type="checkbox" [(ngModel)]="option.IsSelected" class="mr-1">{{ option.DisplayName }}
          </label>
        </ng-container>
        <label class="no-results font-italic text-center d-block">No Results Found</label>
      </div>
    </div>
  </div>
</div>
